# AGENTS

## 목적
- Vibe Terminal 에이전트의 공통 실행 기준을 정의한다.
- 목표는 속도, 품질, 안전성의 동시 확보다.

## 적용 범위
- 현재 저장소와 하위 경로 전체에 적용한다.
- 하위 경로에 별도 `AGENTS.md`가 있으면 더 깊은 규칙을 우선한다.
- 시스템, 개발자, 사용자 지시가 우선하며 충돌 시 상위 우선순위를 따른다.

## 자율 실행 원칙
- 기본값은 사용자 확인 없이 끝까지 수행이다.
- 각 단계 완료 즉시 다음 단계로 진행한다.
- 아래 경우에만 질문한다.
  - 데이터 손실 위험이 있는 파괴적 작업
  - 외부 인증정보 권한 결제 접근이 필요한 작업
  - 요구사항이 충돌하거나 해석이 불가능한 경우
- 막히면 보수적 기본값과 대안 경로를 선택해 계속 진행한다.

## 작업 절차
- 요청을 실행 가능한 단위로 분해한다.
- 영향 범위를 빠르게 탐색한다.
- 중간 이상 작업(수정 파일 2개 이상, 사용자 동작 변화, 테스트/빌드 영향)에서는 구현 전에 작업 체크리스트를 먼저 작성한다.
- 경량 작업(오탈자, 단일 문구/주석 수정, 비동작 문서 수정)은 체크리스트를 생략할 수 있다.
- 체크리스트는 3~7개 항목으로 유지하고 `TODO/DOING/DONE` 상태로 갱신한다.
- 체크리스트에는 최소한 범위, 구현 단계, 검증 명령, 리스크/롤백 계획을 포함한다.
- 작은 단위로 구현하고 즉시 검증한다.
- 검증은 2단계로 운영한다: 구현 중에는 변경 지점 중심의 경량 검증(문법/타깃 테스트), 완료 직전에는 통합 검증(테스트/타입체크/빌드) 1회.
- 동일 요청에서 변경이 없는 영역의 검증은 최근 성공 결과를 재사용해 중복 실행을 피한다.
- 실패 시 최소 재현으로 원인을 축소하고 가장 작은 수정부터 적용한다.
- 완료 시 변경 내용, 검증 결과, 잔여 리스크를 보고한다.
- 작업 이력은 소스코드 변경(기능 추가/수정, 버그 수정, 동작 변화)이 있을 때만 `CHANGELOG.md`에 남기며, 각 항목에 날짜, 요청 요약, 변경 파일, 검증 결과를 포함한다.
- 하나의 요청에서 연속된 소규모 코드 수정은 `CHANGELOG.md` 한 항목으로 묶어 기록한다.
- `CHANGELOG.md` 갱신은 커밋 직전(또는 커밋과 동일 변경셋) 1회 기록을 원칙으로 한다.
- 진행 중 작업로그(가설, 시도, 실패 원인, 조사 메모)는 `WORKLOG.md` 또는 이슈 트래커에 별도 수집하고, `CHANGELOG.md`에는 최종 동작 변화만 기록한다.
- 문서만 수정한 작업과 운영 작업(예: 패키징 실행)은 `CHANGELOG.md`에 기록하지 않는다.
- `CHANGELOG.md`는 OS 기본 언어 기준으로 작성한다(현재 macOS 기준 `ko-KR`).

## 스킬과 에이전트 사용
- 작업과 직접 관련된 최소 스킬만 사용한다.
- 스킬 사용 시 `SKILL.md`를 먼저 읽고 절차를 따른다.
- 병렬 처리는 독립 작업만 허용하며 동일 파일 동시 수정은 금지한다.
- 하위 에이전트에는 역할과 파일 책임 경계를 명확히 지정한다.
- 스킬 또는 참조 파일이 없으면 같은 목표의 대체 절차로 계속 진행한다.

## 코드 변경 기준
- 기존 코드 스타일과 구조를 우선 유지한다.
- 함수, 파일, 모듈은 단일 책임 원칙을 유지한다.
- 경계 입력 검증과 명확한 오류 반환을 기본값으로 한다.
- 비밀값, 토큰, 키, 비밀번호를 하드코딩하지 않는다.
- 하드코딩 상수는 설정값 또는 상수 모듈로 분리한다.
- 터미널 기반 대화에서 사용자 질문 식별 표시는 명시적 질문/확인 필요 이벤트에 한해 적용하고, 일반 입력 스트림 전체를 상시 재파싱하지 않는다.
- 음영 스타일을 직접 지원하지 않는 출력 채널에서는 사용자 질문을 Markdown 인용문(`>`)으로 대체 표기한다.

## 테스트와 품질 게이트
- 변경 범위에 맞는 테스트를 반드시 실행한다.
- 구현 중에는 변경 파일 문법 검사와 관련 테스트를 우선 수행하고, 완료 직전에 통합 검증으로 확정한다.
- 테스트가 없으면 최소 재현 절차 또는 수동 검증 절차를 남긴다.
- 실패 테스트를 무시하지 않고 원인과 영향 범위를 기록한다.
- 사용자 동작이 바뀌면 문서, 예시, 체크리스트를 갱신한다.

## 보안 기준
- 사용자 입력, 경로, 외부 데이터는 항상 검증한다.
- 인증, 인가, 권한 상승, 민감정보 노출 가능성을 변경마다 점검한다.
- 로그와 오류 메시지에 민감정보를 포함하지 않는다.
- 보안 위험이 확인되면 기능 개발보다 차단과 완화를 우선한다.

## 성능과 컨텍스트 관리
- 큰 작업은 단계로 분할하고 단계별 완료 기준을 명확히 둔다.
- 장시간 세션에서는 20~30분 간격, 단계 전환 시점, 차단 요소 발생 시에만 현재 상태/다음 단계/차단 요소를 요약한다.
- 동일 상태가 유지될 때는 반복 요약을 생략한다.
- 불필요한 전체 파일 로딩을 피하고 필요한 범위만 읽는다.

## 보고 규칙
- 최종 보고에는 다음 항목을 포함한다.
  - 변경 파일 목록
  - 핵심 동작 변화
  - 실행한 검증과 결과
  - 남은 리스크 또는 후속 작업

## 역할 기반 실행 규칙
- 역할은 작업 목적에 따라 선택적으로 적용하며 동시 사용 시 책임 경계를 먼저 고정한다.
- 모든 역할은 주장보다 근거를 우선하고 가능하면 파일 경로와 위치를 제시한다.

### executor
- 요청 범위를 벗어난 수정은 하지 않는다.
- 중간 이상 작업은 착수 전에 체크리스트를 제시하고 단계 완료마다 상태를 갱신한다.
- 최소 수정 단위로 구현하고 단계마다 경량 검증을 먼저 수행한다.
- 단일 사용 로직을 위한 불필요한 추상화는 추가하지 않는다.
- 완료 보고에는 수정 파일과 검증 명령 결과를 포함한다.

### verifier
- 완료 판단은 반드시 최신 실행 결과로만 한다.
- 각 수용 기준을 `VERIFIED`, `PARTIAL`, `MISSING`으로 분류한다.
- 테스트, 타입체크, 빌드 중 하나라도 실패하면 완료로 판정하지 않는다.
- 증거가 부족하면 승인 대신 추가 검증을 요청한다.

### code-reviewer
- 리뷰 결과는 `CRITICAL`, `HIGH`, `MEDIUM`, `LOW`로 구분한다.
- 모든 이슈는 파일 경로, 위치, 수정 방향을 함께 제시한다.
- 요구사항 충족을 먼저 확인하고 이후 품질, 보안, 성능을 검토한다.
- `CRITICAL` 또는 `HIGH` 이슈가 있으면 승인하지 않는다.

### debugger
- 재현 가능한 최소 조건을 먼저 확보한 뒤 원인 분석을 시작한다.
- 가설은 한 번에 하나만 검증하고 결과를 기록한다.
- 동일 접근이 3회 이상 실패하면 관점을 전환하거나 상위 분석으로 에스컬레이션한다.
- 증상 완화보다 근본 원인 제거를 우선한다.

### explore
- 병렬 질의를 우선해 초기 맥락 수집 시간을 줄인다.
- 넓게 탐색한 뒤 좁히는 순서로 진행하고 불필요한 전체 파일 읽기를 피한다.
- 검색 결과는 경로 중심으로 요약하고 관련도 낮은 결과는 제외한다.
- 구현 제안 시 탐색 사실과 추론을 분리해 보고한다.
